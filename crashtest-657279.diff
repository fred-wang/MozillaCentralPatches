# HG changeset patch
# Parent a22398ac81271a6f63f4a7701906dff91a7c923d
# User Frédéric Wang <fred.wang@free.fr>
Crashtests for bug 657279. r=karlt.

diff --git a/layout/mathml/crashtests/bug-657279.html b/layout/mathml/crashtests/bug-657279.html
new file mode 100644
--- /dev/null
+++ b/layout/mathml/crashtests/bug-657279.html
@@ -0,0 +1,52 @@
+<html>
+
+<head>
+<title>dynamic maction and embellished op</title>
+
+<script>
+function test()
+{
+  document.getElementById("m1").setAttribute("selection", "2");
+  document.getElementById("m2").setAttribute("selection", "2");
+
+  var m3 = document.getElementById("m3");
+  var m3bis = document.getElementById("m3bis");
+  m3bis.insertBefore(m3.removeChild(m3.firstChild), m3bis.firstChild);
+
+  var m4 = document.getElementById("m4");
+  var m4bis = document.getElementById("m4bis");
+  m4bis.insertBefore(m4.removeChild(m4.firstChild), m4bis.firstChild);
+
+  document.getElementById("m5").setAttribute("selection", "2");
+  document.getElementById("m6").setAttribute("selection", "2");
+
+  document.getElementById("m7").setAttribute("selection", "2");
+  document.getElementById("m8").setAttribute("selection", "2");
+}
+</script>
+</head>
+
+<body onload="test()">
+
+  <p>'<math><maction id="m1"><mi>a</mi><mo>b</mo></maction></math>'</p>
+  <p>'<math><maction id="m2"><mo>b</mo><mi>a</mi></maction></math>'</p>
+ 
+  <p>"<math><maction id="m3"><mi>a</mi><mo>b</mo></maction></math>"</p>
+  <p>"<math><maction id="m3bis"><mo>b</mo></maction></math>"</p>
+
+  <p>{<math><maction id="m4"><mo>b</mo><mi>a</mi></maction></math>}</p>
+  <p>{<math><maction id="m4bis"><mi>a</mi></maction></math>}</p>
+
+ 
+  <p>[<math>
+    <mstyle id="m5"><maction><mi>a</mi><mo>b</mo></maction></mstyle>
+  </math>]</p>
+  <p>[<math>
+    <mstyle id="m6"><maction><mo>b</mo><mi>a</mi></maction></mstyle>
+  </math>]</p>
+
+  <p>(<math id="m7"><maction><mi>a</mi><mo>b</mo></maction></math>)</p>
+  <p>(<math id="m8"><maction><mo>b</mo><mi>a</mi></maction></math>)</p>
+
+</body>
+</html>
diff --git a/layout/mathml/crashtests/crashtests.list b/layout/mathml/crashtests/crashtests.list
--- a/layout/mathml/crashtests/crashtests.list
+++ b/layout/mathml/crashtests/crashtests.list
@@ -49,8 +49,9 @@ load 443089-1.xhtml
 load 463763-1.xhtml
 load 463763-2.xhtml
 load 476547-1.xhtml
 load 477740-1.xhtml
 load 541620-1.xhtml
 load 557474-1.html
 load 655451-1.xhtml
 load 654928-1.html
+load bug-657279.html
