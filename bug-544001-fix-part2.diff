# HG changeset patch
# Parent 05cb34b084e05998c1a181bfa803a870740c293e
# User Andrii Zui <prazuber@gmail.com>
b=544001. Something was fixed here.

diff --git a/embedding/browser/webBrowser/nsDocShellTreeOwner.cpp b/embedding/browser/webBrowser/nsDocShellTreeOwner.cpp
--- a/embedding/browser/webBrowser/nsDocShellTreeOwner.cpp
+++ b/embedding/browser/webBrowser/nsDocShellTreeOwner.cpp
@@ -1096,16 +1096,41 @@ DefaultTooltipTextProvider::GetNodeText(
                   if (titleElement) {
                     titleElement->GetTextContent(outText);
                     if ( outText.Length() )
                       found = true;
                     break;
                   }
                 }
               }
+              else {
+                if (content->GetNameSpaceID() == kNameSpaceID_MathML &&
+                    content->Tag() == nsGkAtoms::maction_) {
+                  nsString actionType;
+                  currElement->GetAttribute(NS_LITERAL_STRING("actiontype"), actionType);
+                  if (actionType.EqualsLiteral("tooltip")) {
+                    nsCOMPtr<nsIDOMNode> firstMactionNode;
+                    if (currElement->GetFirstChild(getter_AddRefs(firstMactionNode))) {
+                      nsCOMPtr<nsIDOMNode> secondMactionNode;
+                      if (firstMactionNode->GetNextSibling(getter_AddRefs(secondMactionNode))) {
+                        nsCOMPtr<nsIDOMElement> secondMactionElement(do_QueryInterface(secondMactionNode));
+                        if (secondMactionElement) {
+                          nsCOMPtr<nsIContent> mtextContent(do_QueryInterface(secondMactionElement));
+                          if (mtextContent && mtextContent->GetNameSpaceID() == kNameSpaceID_MathML &&
+                              mtextContent->Tag() == nsGkAtoms::mtext_) {
+                            mtextContent->GetTextContent(outText);
+                            if (outText.Length())
+                              found = true;
+                          }
+                        }
+                      }
+                    }
+                  }
+                }
+              }
             }
           }
         }
       }
     }
     
     // not found here, walk up to the parent and keep trying
     if ( !found ) {
